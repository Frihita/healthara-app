<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Physical Health Quiz | Healthara</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-emerald-100 to-sky-100 min-h-screen">

  <div class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="max-w-xl w-full bg-white/80 rounded-2xl shadow-xl p-6">
      <div class="flex items-center gap-3 mb-6">
        <button onclick="window.history.back()" class="rounded-full p-2 hover:bg-gray-200">
          <!-- ArrowLeft SVG -->
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h1 class="text-2xl font-bold text-gray-900">Physical Health Quiz</h1>
      </div>
      <div id="quiz-progress" class="mb-4">
        <div class="w-full bg-gray-200 rounded-full h-2">
          <div id="progress-bar" class="bg-emerald-500 h-2 rounded-full transition-all" style="width:0%"></div>
        </div>
        <div class="text-right text-xs mt-1 text-gray-500" id="progress-label"></div>
      </div>
      <form id="quiz-form" class="space-y-6">
        <!-- JS will inject questions here -->
      </form>
      <div id="quiz-nav" class="flex justify-between mt-6">
        <button id="prev-btn" type="button" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-semibold" disabled>Back</button>
        <button id="next-btn" type="button" class="px-4 py-2 rounded-lg bg-emerald-600 text-white font-semibold">Next</button>
      </div>
      <div id="quiz-result" class="hidden mt-8"></div>
    </div>
  </div>

  <script>
    // Quiz questions
    const questions = [
      {
        id: 'age_group',
        type: 'radio',
        question: 'What is your age group?',
        options: [
          { value: 'under_18', label: 'Under 18' },
          { value: '18_30', label: '18-30' },
          { value: '31_45', label: '31-45' },
          { value: '46_60', label: '46-60' },
          { value: '60_plus', label: '60+' }
        ]
      },
      {
        id: 'gender',
        type: 'radio',
        question: 'What is your gender?',
        options: [
          { value: 'male', label: 'Male' },
          { value: 'female', label: 'Female' },
          { value: 'prefer_not_to_say', label: 'Prefer not to say' }
        ]
      },
      {
        id: 'physical_activity',
        type: 'radio',
        question: 'How often do you engage in physical activity (at least 30 minutes)?',
        options: [
          { value: 'daily', label: 'Daily' },
          { value: '3_5_times', label: '3-5 times a week' },
          { value: '1_2_times', label: '1-2 times a week' },
          { value: 'rarely', label: 'Rarely' },
          { value: 'never', label: 'Never' }
        ]
      },
      {
        id: 'diet_quality',
        type: 'radio',
        question: 'How would you describe your daily diet?',
        options: [
          { value: 'balanced', label: 'Balanced (fruits, veggies, proteins, whole grains)' },
          { value: 'high_carbs', label: 'High in carbs/sugars' },
          { value: 'processed', label: 'High in processed/junk foods' },
          { value: 'irregular', label: 'Irregular meals' }
        ]
      },
      {
        id: 'sleep_hours',
        type: 'radio',
        question: 'How many hours of sleep do you get on average?',
        options: [
          { value: '7_9_hours', label: '7-9 hours' },
          { value: '5_6_hours', label: '5-6 hours' },
          { value: 'less_5', label: 'Less than 5 hours' },
          { value: 'more_9', label: 'More than 9 hours' }
        ]
      },
      {
        id: 'weight_height',
        type: 'input',
        question: 'What is your current weight (kg) and height (cm)?',
        inputs: [
          { key: 'weight', label: 'Weight (kg)', type: 'number' },
          { key: 'height', label: 'Height (cm)', type: 'number' }
        ]
      },
      {
        id: 'excessive_thirst',
        type: 'radio',
        question: 'Do you often feel excessive thirst or frequent urination?',
        options: [
          { value: 'yes', label: 'Yes' },
          { value: 'sometimes', label: 'Sometimes' },
          { value: 'no', label: 'No' }
        ]
      },
      {
        id: 'fatigue',
        type: 'radio',
        question: 'Do you frequently feel tired or fatigued even after rest?',
        options: [
          { value: 'yes', label: 'Yes' },
          { value: 'sometimes', label: 'Sometimes' },
          { value: 'no', label: 'No' }
        ]
      },
      {
        id: 'family_history',
        type: 'radio',
        question: 'Does anyone in your immediate family have diabetes, hypertension, or heart disease?',
        options: [
          { value: 'diabetes', label: 'Yes, diabetes' },
          { value: 'hypertension', label: 'Yes, hypertension/heart disease' },
          { value: 'no', label: 'No' }
        ]
      },
      {
        id: 'overall_health',
        type: 'radio',
        question: 'How would you rate your overall health in the past 6 months?',
        options: [
          { value: 'excellent', label: 'Excellent' },
          { value: 'good', label: 'Good' },
          { value: 'fair', label: 'Fair' },
          { value: 'poor', label: 'Poor' }
        ]
      }
    ];

    let currentQuestion = 0;
    let answers = {};

    function renderQuestion() {
      const q = questions[currentQuestion];
      const form = document.getElementById('quiz-form');
      form.innerHTML = '';
      document.getElementById('quiz-result').classList.add('hidden');

      // Progress
      const pct = Math.round(((currentQuestion+1)/questions.length)*100);
      document.getElementById('progress-bar').style.width = pct + '%';
      document.getElementById('progress-label').textContent = `Step ${currentQuestion+1} of ${questions.length}`;

      // Render question
      const qDiv = document.createElement('div');
      qDiv.className = "space-y-4";
      const qLabel = document.createElement('div');
      qLabel.className = "font-semibold text-lg";
      qLabel.textContent = q.question;
      qDiv.appendChild(qLabel);

      if (q.type === 'radio') {
        q.options.forEach(opt => {
          const id = `${q.id}_${opt.value}`;
          const wrapper = document.createElement('div');
          wrapper.className = "flex items-center gap-2";
          const input = document.createElement('input');
          input.type = 'radio';
          input.name = q.id;
          input.id = id;
          input.value = opt.value;
          input.className = "accent-emerald-600";
          if (answers[q.id] === opt.value) input.checked = true;
          input.onchange = () => { answers[q.id] = opt.value; };
          const label = document.createElement('label');
          label.htmlFor = id;
          label.textContent = opt.label;
          wrapper.appendChild(input);
          wrapper.appendChild(label);
          qDiv.appendChild(wrapper);
        });
      } else if (q.type === 'input') {
        q.inputs.forEach(inp => {
          const wrapper = document.createElement('div');
          wrapper.className = "flex flex-col gap-1";
          const label = document.createElement('label');
          label.textContent = inp.label;
          const input = document.createElement('input');
          input.type = inp.type;
          input.className = "border rounded-md p-2";
          input.value = answers[q.id]?.[inp.key] || '';
          input.oninput = (e) => {
            if (!answers[q.id]) answers[q.id] = {};
            answers[q.id][inp.key] = e.target.value;
          };
          wrapper.appendChild(label);
          wrapper.appendChild(input);
          qDiv.appendChild(wrapper);
        });
      }
      form.appendChild(qDiv);

      // Nav buttons
      document.getElementById('prev-btn').disabled = currentQuestion === 0;
      document.getElementById('next-btn').textContent = currentQuestion === questions.length-1 ? "Submit" : "Next";
    }

    function showResults() {
      // Calculate risk and recommendations
      let riskScore = 0;
      let recommendations = [];
      // BMI
      const wh = answers.weight_height || {};
      if (wh.weight && wh.height) {
        const weight = parseFloat(wh.weight);
        const height = parseFloat(wh.height);
        if (weight > 0 && height > 0) {
          const heightM = height / 100;
          const bmi = weight / (heightM * heightM);
          if (bmi < 18.5) {
            riskScore += 1;
            recommendations.push("Consider consulting a nutritionist to achieve a healthy weight.");
          } else if (bmi > 25) {
            riskScore += 2;
            recommendations.push("Focus on balanced nutrition and regular exercise for weight management.");
          }
        }
      }
      // Activity
      if (answers.physical_activity === 'never' || answers.physical_activity === 'rarely') {
        riskScore += 3;
        recommendations.push("Gradually increase physical activity - start with 15-30 minutes daily walks.");
      }
      // Diet
      if (answers.diet_quality === 'processed' || answers.diet_quality === 'irregular') {
        riskScore += 2;
        recommendations.push("Focus on whole foods, regular meal times, and balanced nutrition.");
      }
      // Sleep
      if (answers.sleep_hours === 'less_5') {
        riskScore += 2;
        recommendations.push("Prioritize getting 7-9 hours of quality sleep each night.");
      }
      // Symptoms
      if (answers.excessive_thirst === 'yes' || answers.fatigue === 'yes') {
        riskScore += 3;
        recommendations.push("Consider consulting a healthcare provider for these symptoms.");
      }
      // Family history
      if (answers.family_history && answers.family_history !== 'no') {
        riskScore += 2;
        recommendations.push("Regular health checkups are important due to family history.");
      }
      // Overall health
      if (answers.overall_health === 'fair' || answers.overall_health === 'poor') {
        riskScore += 2;
        recommendations.push("Focus on healthy habits and regular checkups.");
      }

      // Output
      const resultDiv = document.getElementById('quiz-result');
      resultDiv.className = "mt-8";
      let verdict = riskScore >= 6 ? "⚠️ Some risk factors detected" : "✅ You're in a good zone!";
      resultDiv.innerHTML = `
        <div class="text-xl font-bold mb-2">${verdict}</div>
        <div class="mb-2">Your risk score: <span class="font-semibold">${riskScore}</span></div>
        <div class="mb-2">
          <span class="font-semibold">Recommendations:</span>
          <ul class="list-disc ml-6">${recommendations.map(r=>`<li>${r}</li>`).join('')}</ul>
        </div>
        <button onclick="location.reload()" class="mt-4 px-4 py-2 rounded-lg bg-emerald-600 text-white font-semibold">Restart Quiz</button>
      `;
      document.getElementById('quiz-form').innerHTML = '';
      document.getElementById('quiz-nav').classList.add('hidden');
    }

    // Navigation
    document.getElementById('prev-btn').onclick = function() {
      if (currentQuestion > 0) {
        currentQuestion--;
        renderQuestion();
      }
    };
    document.getElementById('next-btn').onclick = function() {
      // Validate
      const q = questions[currentQuestion];
      if (q.type === 'radio' && !answers[q.id]) {
        alert('Please select an option.');
        return;
      }
      if (q.type === 'input') {
        let valid = true;
        q.inputs.forEach(inp => {
          if (!answers[q.id] || !answers[q.id][inp.key]) valid = false;
        });
        if (!valid) {
          alert('Please fill in all fields.');
          return;
        }
      }
      if (currentQuestion === questions.length-1) {
        showResults();
      } else {
        currentQuestion++;
        renderQuestion();
      }
    };

    // Initial render
    renderQuestion();
  </script>
</body>
</html>
